{"version":3,"sources":["../../src/models/answersModel.js"],"names":["dbOrcl","answersModel","getReport","Promise","resolve","reject","sql","doConnect","then","doExecuteArr","connection","arrRows","processResultSet","result","resultSet","getRow","row","doCloseResultSet","push","catch","doClose","status","msg","detail_msg","err","message"],"mappings":";;;;;;AAAA;;;;;;;;AAEA,IAAIA,SAAS,kBAAb;;IAEqBC,Y;;;SACjBC,S,GAAY,YAAM;AACd,eAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,gBAAIC,MAAM,0CAAV;AACAN,mBAAOO,SAAP,GACKC,IADL,CACU,sBAAc;AAChB,uBAAOR,OAAOS,YAAP,CAAoBC,UAApB,EAAgCJ,GAAhC,EACFE,IADE,CACG,kBAAU;AACZ,wBAAIG,UAAU,EAAd;;AAEA,6BAASC,gBAAT,GAA4B;AACxBC,+BAAOC,SAAP,CAAiBC,MAAjB,GACKP,IADL,CACU,eAAO;AACT,gCAAI,CAACQ,GAAL,EAAU;AACNhB,uCAAOiB,gBAAP,CAAwBJ,OAAOC,SAA/B;AACA,uCAAOV,QAAQO,OAAR,CAAP;AACH;AACDA,oCAAQO,IAAR,CAAaF,GAAb;AACAJ;AACH,yBARL;AASH;AACDA;AACH,iBAhBE,EAiBFO,KAjBE,CAiBI,eAAO;AACVnB,2BAAOoB,OAAP,CAAeV,UAAf;AACAL,2BAAO,EAACgB,QAAQ,GAAT,EAAcC,KAAK,oBAAnB,EAAyCC,YAAYC,IAAIC,OAAzD,EAAP;AACH,iBApBE,CAAP;AAqBH,aAvBL,EAwBKN,KAxBL,CAwBW,eAAO;AACVd,uBAAO,EAACgB,QAAQ,GAAT,EAAcC,KAAK,wBAAnB,EAA6CC,YAAYC,IAAIC,OAA7D,EAAP;AACH,aA1BL;AA2BH,SA7BM,CAAP;AA8BH,K;;;kBAhCgBxB,Y","file":"answersModel.js","sourcesContent":["import Db from './db';\r\n\r\nlet dbOrcl = new Db();\r\n\r\nexport default class answersModel {\r\n    getReport = () => {\r\n        return new Promise((resolve, reject) => {\r\n            let sql = 'select * from X$USERS t order by xu$name';\r\n            dbOrcl.doConnect()\r\n                .then(connection => {\r\n                    return dbOrcl.doExecuteArr(connection, sql)\r\n                        .then(result => {\r\n                            let arrRows = [];\r\n\r\n                            function processResultSet() {\r\n                                result.resultSet.getRow()\r\n                                    .then(row => {\r\n                                        if (!row) {\r\n                                            dbOrcl.doCloseResultSet(result.resultSet);\r\n                                            return resolve(arrRows);\r\n                                        }\r\n                                        arrRows.push(row);\r\n                                        processResultSet();\r\n                                    })\r\n                            }\r\n                            processResultSet();\r\n                        })\r\n                        .catch(err => {\r\n                            dbOrcl.doClose(connection);\r\n                            reject({status: 500, msg: \"Error getting data\", detail_msg: err.message});\r\n                        })\r\n                })\r\n                .catch(err => {\r\n                    reject({status: 500, msg: \"Error connecting to DB\", detail_msg: err.message});\r\n                });\r\n        })\r\n    };\r\n}"]}
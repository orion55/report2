{"version":3,"sources":["../../src/oracle/excel1.js"],"names":["app","post","req","res","body","length","console","log","data","index","filename","workbook","Workbook","fromFile","err","status","send","sheet","getSheet","i","rowNum","parseInt","row","getRow","colNum","cell","getCell","exceldata","dateNow","Date","dd","getDate","monthSingleDigit","getMonth","mm","yy","getFullYear","toString","date","setValue","toFileSync","fs","exists","unlink"],"mappings":";;AAAAA,IAAIC,IAAJ,CAAS,yBAAT,EAAoC,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACpD,QAAID,IAAIE,IAAJ,CAASC,MAAT,GAAkB,CAAtB,EAAyB;AACrBC,gBAAQC,GAAR,CAAY,MAAZ;AACA,YAAIC,OAAON,IAAIE,IAAf;AACA,YAAIK,QAAQ,CAAC,OAAD,EAAU,YAAV,EAAwB,WAAxB,EAAqC,OAArC,EAA8C,aAA9C,EAA6D,WAA7D,CAAZ;AACA,YAAIC,WAAW,uBAAf;AACA,YAAIC,WAAWC,SAASC,QAAT,CAAkB,2CAAlB,EAA+D,UAAUC,GAAV,EAAeH,QAAf,EAAyB;AACnG,gBAAIG,GAAJ,EAAS,OAAOX,IAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,GAArB,CAAP;AACT,gBAAIG,QAAQN,SAASO,QAAT,CAAkB,CAAlB,CAAZ;AACA,gBAAIC,IAAI,CAAR;AACA,iBAAK,IAAIC,SAAS,CAAlB,EAAqBA,SAASC,SAASb,KAAKH,MAAd,IAAwB,CAAtD,EAAyDe,QAAzD,EAAmE;AAC/D,oBAAIE,MAAML,MAAMM,MAAN,CAAaH,MAAb,CAAV;AACA,qBAAK,IAAII,SAAS,CAAlB,EAAqBA,SAASH,SAASZ,MAAMJ,MAAf,IAAyB,CAAvD,EAA0DmB,QAA1D,EAAoE;AAChE,wBAAIC,OAAOH,IAAII,OAAJ,CAAYF,MAAZ,CAAX;AACA,wBAAIG,YAAY,EAAhB;AACA,wBAAI,CAAClB,MAAMe,SAAS,CAAf,MAAsB,aAAtB,IAAuCf,MAAMe,SAAS,CAAf,MAAsB,WAA9D,KAA8E,OAAOhB,KAAKW,CAAL,EAAQV,MAAMe,SAAS,CAAf,CAAR,CAAP,KAAsC,WAAxH,EAAqI;AACjI,4BAAII,UAAU,IAAIC,IAAJ,CAASrB,KAAKW,CAAL,EAAQV,MAAMe,SAAS,CAAf,CAAR,CAAT,CAAd;AACA,4BAAIM,KAAKF,QAAQG,OAAR,KAAoB,EAApB,GAAyB,MAAMH,QAAQG,OAAR,EAA/B,GAAmDH,QAAQG,OAAR,EAA5D;AACA,4BAAIC,mBAAmBJ,QAAQK,QAAR,KAAqB,CAA5C;AACA,4BAAIC,KAAKF,mBAAmB,EAAnB,GAAwB,MAAMA,gBAA9B,GAAiDA,gBAA1D;AACA,4BAAIG,KAAKP,QAAQQ,WAAR,GAAsBC,QAAtB,EAAT;AACAV,oCAAYW,OAAOR,KAAK,GAAL,GAAWI,EAAX,GAAgB,GAAhB,GAAsBC,EAAzC;AACH,qBAPD,MAOO;AACHR,oCAAYnB,KAAKW,CAAL,EAAQV,MAAMe,SAAS,CAAf,CAAR,CAAZ;AACH;;AAEDC,yBAAKc,QAAL,CAAcZ,SAAd;AACH;AACDR;AACH;;AAEDR,qBAAS6B,UAAT,CAAoB,6BAA6B9B,QAAjD;AACAP,gBAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,QAAQN,QAAT,EAArB;AACA+B,eAAGC,MAAH,CAAU,6BAA6BhC,QAAvC,EAAiD,UAAUgC,MAAV,EAAkB;AAC/D,oBAAIA,MAAJ,EAAY;AACRD,uBAAGE,MAAH,CAAU,6BAA6BjC,QAAvC;AACH;AACDC,yBAAS6B,UAAT,CAAoB,6BAA6B9B,QAAjD;AACAP,oBAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,QAAQN,QAAT,EAArB;AAEH,aAPD;AASH,SApCc,CAAf;AAqCH;AACJ,CA5CD","file":"excel1.js","sourcesContent":["app.post('/writeEmployeeDataExcel', function (req, res) {\r\n    if (req.body.length > 0) {\r\n        console.log('here');\r\n        let data = req.body;\r\n        let index = ['title', 'first_name', 'last_name', 'email', 'dateofbirth', 'hire_date'];\r\n        let filename = \"newemployeesheet.xlsx\";\r\n        let workbook = Workbook.fromFile(\"../client/app/downloads/employeeTemp.xlsx\", function (err, workbook) {\r\n            if (err) return res.status(500).send(err);\r\n            let sheet = workbook.getSheet(0);\r\n            let i = 0;\r\n            for (let rowNum = 2; rowNum < parseInt(data.length) + 2; rowNum++) {\r\n                let row = sheet.getRow(rowNum);\r\n                for (let colNum = 1; colNum < parseInt(index.length) + 1; colNum++) {\r\n                    let cell = row.getCell(colNum);\r\n                    let exceldata = '';\r\n                    if ((index[colNum - 1] === 'dateofbirth' || index[colNum - 1] === 'hire_date') && typeof data[i][index[colNum - 1]] !== 'undefined') {\r\n                        let dateNow = new Date(data[i][index[colNum - 1]]);\r\n                        let dd = dateNow.getDate() < 10 ? '0' + dateNow.getDate() : dateNow.getDate();\r\n                        let monthSingleDigit = dateNow.getMonth() + 1;\r\n                        let mm = monthSingleDigit < 10 ? '0' + monthSingleDigit : monthSingleDigit;\r\n                        let yy = dateNow.getFullYear().toString();\r\n                        exceldata = date = dd + '/' + mm + '/' + yy;\r\n                    } else {\r\n                        exceldata = data[i][index[colNum - 1]];\r\n                    }\r\n\r\n                    cell.setValue(exceldata);\r\n                }\r\n                i++;\r\n            }\r\n\r\n            workbook.toFileSync(\"../client/app/downloads/\" + filename);\r\n            res.status(200).send({'name': filename});\r\n            fs.exists(\"../client/app/downloads/\" + filename, function (exists) {\r\n                if (exists) {\r\n                    fs.unlink(\"../client/app/downloads/\" + filename);\r\n                }\r\n                workbook.toFileSync(\"../client/app/downloads/\" + filename);\r\n                res.status(200).send({'name': filename});\r\n\r\n            });\r\n\r\n        });\r\n    }\r\n});"]}